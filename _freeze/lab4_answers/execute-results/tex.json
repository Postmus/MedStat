{
  "hash": "1644405ce2a6ff1e55506508b640134e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Medical Statistics – Answers lab 4\"\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    toc-location: right\n  pdf:\n    toc: false\nexecute:\n  warning: false\n  message: false\n  error: false\n  eval: true\n---\n\n# Part 1: Inference for categorical data\n\n::: {.callout-important icon=false title=\"Question 1\"}\nUsing the data provided in the table, calculate an approximate 95% confidence interval for the difference in proportions of post-surgical complications between smokers and non-smokers.\n:::\n\n::: {.callout-tip icon=false title=\"Answer question 1\"}\n* Step 1: Extract the data\n  - Smokers with complications: $x_1 = 8$, Total smokers: $n_1 = 20$\n  - Non-smokers with complications: $x_2 = 10$, Total non-smokers: $n_2 = 60$\n\n* Step 2: Calculate the sample proportions\n  - $p_1 = \\frac{x_1}{n_1} = \\frac{8}{20} = 0.4$\n  - $p_2 = \\frac{x_2}{n_2} = \\frac{10}{60} \\approx 0.167$\n\n* Step 3: Compute the difference in proportions\n  - $\\text{Difference} = p_1 - p_2 = 0.4 - 0.167 \\approx 0.233$\n\n* Step 4: Calculate the standard error (SE) of the difference\n  - $\\text{SE} = \\sqrt{\\frac{p_1(1-p_1)}{n_1} + \\frac{p_2(1-p_2)}{n_2}}$\n  - $\\text{SE} = \\sqrt{\\frac{0.4(1-0.4)}{20} + \\frac{0.167(1-0.167)}{60}} \\approx 0.120$\n\n* Step 5: Determine the 95% confidence interval\n  - $Z_{critical} = 1.96$\n  - $\\text{Lower bound} = \\text{Difference} - Z_{critical} \\times \\text{SE} = 0.233 - 1.96 \\times 0.0.120 \\approx -0.001$\n  - $\\text{Upper bound} = \\text{Difference} + Z_{critical} \\times \\text{SE} = 0.233 + 1.96 \\times 0.120 \\approx 0.468$\n\n* Step 6: Conclusion\n  - The 95% confidence interval is approximately $(-0.001, 0.468)$\n:::\n\n::: {.callout-important icon=false title=\"Question 2\"}\nBased on the 95% confidence interval, can we conclude that there is a statistically significant difference in the proportion of post-surgical complications between smokers and non-smokers?\n:::\n\n::: {.callout-tip icon=false title=\"Answer question 2\"}\nThe 95% confidence interval for the difference in proportions is $(-0.001, 0.468)$. Since this interval includes zero, we cannot reject the null hypothesis that the two proportions are equal. Therefore, we do not have sufficient evidence to conclude that there is a statistically significant difference in the proportion of post-surgical complications between smokers and non-smokers.\n:::\n\nResults of the two-sample test of proportions based on the normal approximation with continuity correction:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a contingency table\ncomplications <- matrix(c(8, 12, 10, 50), nrow = 2, byrow = TRUE)\ncolnames(complications) <- c(\"Complication\", \"No Complication\")\nrownames(complications) <- c(\"Smokers\", \"Non-smokers\")\ncomplications <- as.table(complications)\n\nprop.test(complications)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\t2-sample test for equality of proportions with continuity correction\n\ndata:  complications\nX-squared = 3.4409, df = 1, p-value = 0.0636\nalternative hypothesis: two.sided\n95 percent confidence interval:\n -0.03449898  0.50116565\nsample estimates:\n   prop 1    prop 2 \n0.4000000 0.1666667 \n```\n\n\n:::\n:::\n\n\n::: {.callout-important icon=false title=\"Question 3\"}\nBased on the results of the test, can we conclude that there is a statistically significant difference in the proportion of post-surgical complications between smokers and non-smokers?\n:::\n\n::: {.callout-tip icon=false title=\"Answer question 3\"}\nThe p-value from the two-sample test of proportions is 0.064. Since this p-value is greater than the significance level of 0.05, we do not have sufficient evidence to reject the null hypothesis. Therefore, we cannot conclude that there is a statistically significant difference in the proportion of post-surgical complications between smokers and non-smokers.\n:::\n\n::: {.callout-important icon=false title=\"Question 4\"}\nIn addition to the p-value, output of the `prop.test()` function also provides an approximate 95% confidence interval for the difference in proportions. How does this confidence interval compare to the one you calculated manually?\n:::\n\n::: {.callout-tip icon=false title=\"Answer question 4\"}\nThe 95% confidence interval for the difference in proportions was $(-0.001, 0.468)$. This is an approximate interval without continuity correction. The confidence interval provided in the output above is slightly wider due to the continuity correction. Without continuity correction (`adjust = FALSE` in R), the confidence interval provided by the `prop.test()` function is the same as the one that was calculated manually. SPSS gave the same result as R.\n:::\n\n### Checking of assumptions\n\n::: {.callout-important icon=false title=\"Exercise\"}\nCheck this assumption by calculating the expected counts for each cell in the contingency table.\n:::\n\n::: {.callout-important icon=false title=\"Question 5\"}\nIs it reasonable to use the normal approximation in this case?\n:::\n\n::: {.callout-tip icon=false title=\"Answer question 5\"}\nThe expected counts for each cell in the contingency t able are as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq_test_overall <- chisq.test(complications)\nchisq_test_overall$expected\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Complication No Complication\nSmokers              4.5            15.5\nNon-smokers         13.5            46.5\n```\n\n\n:::\n:::\n\n\nOne of the cells in the contingency table has an expected count just below 5, which indicates that the two sample Z-test may not be fully accurate in this case.\n:::\n\n### Fisher's exact test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfisher.test(complications)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  complications\np-value = 0.05967\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n  0.9154957 11.7051187\nsample estimates:\nodds ratio \n  3.274581 \n```\n\n\n:::\n:::\n\n\n::: {.callout-important icon=false title=\"Question 6\"}\nBased on the results of Fisher's exact test, can we conclude that there is a statistically significant difference in the proportion of post-surgical complications between smokers and non-smokers?\n:::\n\n::: {.callout-tip icon=false title=\"Answer question 6\"}\nThe p-value from Fisher's exact test is 0.060. Since this p-value is greater than the significance level of 0.05, we do not have sufficient evidence to reject the null hypothesis. Therefore, we cannot conclude that there is a statistically significant difference in the proportion of post-surgical complications between smokers and non-smokers.\n:::\n\n## Vaccine side effects across age groups\n\n### Chi-square test of homogeneity\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a contingency table\nside_effects <- matrix(c(50, 30, 10, 40, 40, 20, 30, 50, 40), nrow = 3, byrow = TRUE)\ncolnames(side_effects) <- c(\"None\", \"Mild\", \"Severe\")\nrownames(side_effects) <- c(\"18–39\", \"40–59\", \"60+\")\nside_effects <- as.table(side_effects)\nside_effects\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      None Mild Severe\n18–39   50   30     10\n40–59   40   40     20\n60+     30   50     40\n```\n\n\n:::\n\n```{.r .cell-code}\n# Perform the chi-square test of homogeneity\nchisq_test_overall <- chisq.test(side_effects)\nprint(chisq_test_overall)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  side_effects\nX-squared = 25.136, df = 4, p-value = 4.723e-05\n```\n\n\n:::\n:::\n\n\n::: {.callout-important icon=false title=\"Question 7\"}\nBased on the results of the chi-square test, can we conclude that the distribution of vaccine side effects is consistent across the three age groups?\n:::\n\n::: {.callout-tip icon=false title=\"Answer question 7\"}\nThe p-value from the chi-square test of homogeneity is <0.0001. Since this p-value is less than the significance level of 0.05, we have sufficient evidence to reject the null hypothesis. Therefore, we can conclude that the distribution of vaccine side effects is not consistent across the three age groups.\n:::\n\n#### Checking of assumptions\n\n::: {.callout-important icon=false title=\"Question 8\"}\nAre the expected cell counts greater than 5 for the different cells in the contingency table?\n:::\n\nExpected cell counts:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Retrieve the table of expected counts\nchisq_test_overall$expected\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          None     Mild   Severe\n18–39 34.83871 34.83871 20.32258\n40–59 38.70968 38.70968 22.58065\n60+   46.45161 46.45161 27.09677\n```\n\n\n:::\n:::\n\n\n::: {.callout-tip icon=false title=\"Answer question 8\"}\nThe expected counts in all cells are well above 5, which indicates that the normal approximation is appropriate in this case.\n:::\n\n#### Post-hoc pairwise comparisons\n\n**Comparison of age groups 18–39 and 40–59**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable_12 <- side_effects[c(\"18–39\", \"40–59\"), ]\ntable_12\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      None Mild Severe\n18–39   50   30     10\n40–59   40   40     20\n```\n\n\n:::\n\n```{.r .cell-code}\n# Perform chi-square test for the subset of data\nchisq_test_12 <- chisq.test(table_12)\nprint(chisq_test_12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  table_12\nX-squared = 5.3616, df = 2, p-value = 0.06851\n```\n\n\n:::\n\n```{.r .cell-code}\n# Adjust the p-value for multiple testing\np_adjusted_12 <- 3*chisq_test_12$p.value\n```\n:::\n\n\nThe Bonferroni-corrected p-value for this comparison is 0.206.\n\n:::{.callout-important icon=false title=\"Exercise\"}\nPerform the pairwise comparison between the other two pairs of age groups (40–59 and 60+, 18–39 and 60+) using the same approach.\n:::\n\n**Comparison of age groups 18–39 and 60+**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable_13 <- side_effects[c(\"18–39\", \"60+\"), ]\ntable_13\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      None Mild Severe\n18–39   50   30     10\n60+     30   50     40\n```\n\n\n:::\n\n```{.r .cell-code}\n# Perform chi-square test for the subset of data\nchisq_test_13 <- chisq.test(table_13)\nprint(chisq_test_13)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  table_13\nX-squared = 24.208, df = 2, p-value = 5.536e-06\n```\n\n\n:::\n\n```{.r .cell-code}\n# Adjust the p-value for multiple testing\np_adjusted_13 <- 3*chisq_test_13$p.value\n```\n:::\n\n\nThe Bonferroni-corrected p-value for this comparison is <0.0001.\n\n**Comparison of age groups 40-59 and 60+**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable_23 <- side_effects[c(\"40–59\", \"60+\"), ]\ntable_23\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      None Mild Severe\n40–59   40   40     20\n60+     30   50     40\n```\n\n\n:::\n\n```{.r .cell-code}\n# Perform chi-square test for the subset of data\nchisq_test_23 <- chisq.test(table_23)\nprint(chisq_test_23)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  table_23\nX-squared = 7.4497, df = 2, p-value = 0.02412\n```\n\n\n:::\n\n```{.r .cell-code}\n# Adjust the p-value for multiple testing\np_adjusted_23 <- 3*chisq_test_23$p.value\n```\n:::\n\n\nThe Bonferroni-corrected p-value for this comparison is 0.072.\n\n:::{.callout-important icon=false title=\"Question 9\"}\nBased on the results of the pairwise comparisons, which age groups have significantly different distributions of side effects?\n:::\n\n:::{.callout-tip icon=false title=\"Answer question 9\"}\nBased on the adjusted p-values from the pairwise comparisons, we can conclude that the distributions of side effects are significantly different between the age groups 18–39 and 60+ (Bonferroni-corrected p-value < 0.001). However, there were no significant differences between the age groups 40–59 and 60+ (Bonferroni-corrected p-value = 0.072) or between the age groups 18–39 and 40–59 (Bonferroni-corrected p-value = 0.206).\n:::\n\n# Part 2: Analysis of paired continous data\n\n\n\nResults of the paired t-test:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform paired t-test\nt_test <- t.test(pockets$pocket_depth_before,\n                 pockets$pocket_depth_after,\n                 paired = TRUE)\nprint(t_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  pockets$pocket_depth_before and pockets$pocket_depth_after\nt = 11.133, df = 95, p-value < 2.2e-16\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 0.09140772 0.13108091\nsample estimates:\nmean difference \n      0.1112443 \n```\n\n\n:::\n:::\n\n\n:::{.callout-important icon=false title=\"Question 10\"}\nBased on the results of the paired t-test, can we conclude that the intervention significantly reduces pocket depth?\n:::\n\n:::{.callout-tip icon=false title=\"Answer question 10\"}\nThe p-value from the paired t-test is <0.0001, which is less than the significance level of 0.05. Therefore, we have sufficient evidence to reject the null hypothesis and conclude that the intervention significantly reduces pocket depth.\n:::\n\n#### Checking of assumptions\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the differences in pocket depth\npockets$diff <- pockets$pocket_depth_after -\n                pockets$pocket_depth_before\n\n# Create a histogram of the differences\nlibrary(ggplot2)\nggplot(pockets, aes(x = diff)) +\n  geom_histogram(binwidth = 0.05,\n                 fill = \"skyblue\",\n                 color = \"black\") +\n  labs(title = \"Distribution of differences in pocket depth\",\n       x = \"Difference in pocket depth (mm)\",\n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](lab4_answers_files/figure-pdf/unnamed-chunk-11-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n:::{.callout-important icon=false title=\"Question 11\"}\nBased on the histogram, do the differences in pocket depth appear to be approximately normally distributed?\n:::\n\n:::{.callout-tip icon=false title=\"Answer question 11\"}\nThe histogram of the differences in pocket depth is left-skewed, indicating that the distribution is not normal and that we may therefore be better of using a sign test.\n:::\n\n### Sign test\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform the sign test\n# There are 7 positive signs out of 96 pairs with either a positive or negative sign\nsign_test <- binom.test(7, 96, p = 0.5)\nprint(sign_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tExact binomial test\n\ndata:  7 and 96\nnumber of successes = 7, number of trials = 96, p-value < 2.2e-16\nalternative hypothesis: true probability of success is not equal to 0.5\n95 percent confidence interval:\n 0.02981784 0.14447971\nsample estimates:\nprobability of success \n            0.07291667 \n```\n\n\n:::\n:::\n\n\n:::{.callout-important icon=false title=\"Question 12\"}\nBased on the results of the sign test, can we conclude that the intervention significantly reduces pocket depth?\n:::\n\n:::{.callout-tip icon=false title=\"Answer question 12\"}\nThe p-value from the sign test is <0.0001, which is less than the significance level of 0.05. Therefore, we have sufficient evidence to reject the null hypothesis and conclude that the intervention significantly reduces pocket depth.\n:::\n\n### Wilcoxon signed-rank test\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform the Wilcoxon signed-rank test\nwilcox_test <- wilcox.test(pockets$pocket_depth_before,\n                           pockets$pocket_depth_after,\n                           paired = TRUE)\nprint(wilcox_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  pockets$pocket_depth_before and pockets$pocket_depth_after\nV = 4572, p-value = 2.435e-16\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n:::{.callout-important icon=false title=\"Question 13\"}\nBased on the results of the Wilcoxon signed-rank test, can we conclude that the intervention significantly reduces pocket depth?\n:::\n\n:::{.callout-tip icon=false title=\"Answer question 13\"}\nThe p-value from the Wilcoxon signed-rank test is <0.0001, which is less than the significance level of 0.05. Therefore, we have sufficient evidence to reject the null hypothesis and conclude that the intervention significantly reduces pocket depth.\n:::\n\n# Part 3: Analysis of paired dichotomous data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the table for DNCB and Croton Oil responses\nskin_response_table <- matrix(c(81, 23, 48, 21), nrow = 2, byrow = TRUE)\ncolnames(skin_response_table) <- c(\"DNCB +ve\", \"DNCB -ve\")\nrownames(skin_response_table) <- c(\"Croton Oil +ve\", \"Croton Oil -ve\")\nskin_response_table <- as.table(skin_response_table)\n\n# Print the table\nskin_response_table\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               DNCB +ve DNCB -ve\nCroton Oil +ve       81       23\nCroton Oil -ve       48       21\n```\n\n\n:::\n:::\n\n\nResults of the McNemar test:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform the McNemar test\nmcnemar_test <- mcnemar.test(skin_response_table)\nprint(mcnemar_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMcNemar's Chi-squared test with continuity correction\n\ndata:  skin_response_table\nMcNemar's chi-squared = 8.1127, df = 1, p-value = 0.004396\n```\n\n\n:::\n:::\n\n\n:::{.callout-important icon=false title=\"Question 14\"}\nBased on the results of the McNemar test, can we conclude that there is a significant difference in the proportions of patients with a negative response to DNCB and croton oil? If so, can you determine which substance is associated with a higher proportion of negative responses?\n:::\n\n:::{.callout-tip icon=false title=\"Answer question 14\"}\nThe p-value from the McNemar test is 0.0044, which is less than the significance level of 0.05. Therefore, we have sufficient evidence to reject the null hypothesis and conclude that there is a significant difference in the proportions of patients with a negative response to DNCB and croton oil. The test does not provide information on which substance is associated with a higher proportion of negative responses. To address this question, we can calculate the estimated proportion of negative responses for each substance, which is $44/173 = 0.25$ for DNCB and $69/173 = 0.40$ for croton oil. Therefore, croton oil is associated with a higher proportion of negative responses.\n:::\n",
    "supporting": [
      "lab4_answers_files\\figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}