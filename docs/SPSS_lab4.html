<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Medical Statistics – Lab 4 – Medical Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-3790baeb23ec48fe6a2a71a48d01fb7e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Medical Statistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs-day-1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs day 1</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs-day-1">    
        <li>
    <a class="dropdown-item" href="./R_lab1.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS_lab1.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs-day-2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs day 2</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs-day-2">    
        <li>
    <a class="dropdown-item" href="./R_lab2.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS_lab2.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs-day-3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs day 3</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs-day-3">    
        <li>
    <a class="dropdown-item" href="./R_lab3.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS_lab3.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs-day-4" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs day 4</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs-day-4">    
        <li>
    <a class="dropdown-item" href="./R_lab4.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS_lab4.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lab-day-5" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lab day 5</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lab-day-5">    
        <li>
    <a class="dropdown-item" href="./lab5.html">
 <span class="dropdown-text">Lab 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs-day-6" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs day 6</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs-day-6">    
        <li>
    <a class="dropdown-item" href="./R_lab6.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS_lab6.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-answers" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Answers</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-answers">    
        <li>
    <a class="dropdown-item" href="./lab1_answers.html">
 <span class="dropdown-text">Lab 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab2_answers.html">
 <span class="dropdown-text">Lab 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab3_answers.html">
 <span class="dropdown-text">Lab 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab4_answers.html">
 <span class="dropdown-text">Lab 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-datasets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Datasets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-datasets">    
        <li>
    <a class="dropdown-item" href="./datasets/lowbwt.sav">
 <span class="dropdown-text">lowbwt.sav</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datasets/ex5_6.sav">
 <span class="dropdown-text">ex5_6.sav</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datasets/pockets_paired.sav">
 <span class="dropdown-text">pockets_paired.sav</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datasets/heart_disease_cleveland.sav">
 <span class="dropdown-text">heart_disease_cleveland.sav</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datasets/pockets.sav">
 <span class="dropdown-text">pockets.sav</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#part-1-inference-for-categorical-data" id="toc-part-1-inference-for-categorical-data" class="nav-link active" data-scroll-target="#part-1-inference-for-categorical-data">Part 1: Inference for categorical data</a>
  <ul class="collapse">
  <li><a href="#smoking-and-post-surgical-complications" id="toc-smoking-and-post-surgical-complications" class="nav-link" data-scroll-target="#smoking-and-post-surgical-complications">Smoking and post-surgical complications</a>
  <ul class="collapse">
  <li><a href="#confidence-intervals-and-hypothesis-testing-for-the-difference-in-proportions-using-the-normal-approximation" id="toc-confidence-intervals-and-hypothesis-testing-for-the-difference-in-proportions-using-the-normal-approximation" class="nav-link" data-scroll-target="#confidence-intervals-and-hypothesis-testing-for-the-difference-in-proportions-using-the-normal-approximation">Confidence intervals and hypothesis testing for the difference in proportions using the normal approximation</a></li>
  <li><a href="#checking-of-assumptions" id="toc-checking-of-assumptions" class="nav-link" data-scroll-target="#checking-of-assumptions">Checking of assumptions</a></li>
  <li><a href="#fishers-exact-test" id="toc-fishers-exact-test" class="nav-link" data-scroll-target="#fishers-exact-test">Fisher’s exact test</a></li>
  </ul></li>
  <li><a href="#vaccine-side-effects-across-age-groups" id="toc-vaccine-side-effects-across-age-groups" class="nav-link" data-scroll-target="#vaccine-side-effects-across-age-groups">Vaccine side effects across age groups</a>
  <ul class="collapse">
  <li><a href="#chi-square-test-of-homogeneity" id="toc-chi-square-test-of-homogeneity" class="nav-link" data-scroll-target="#chi-square-test-of-homogeneity">Chi-square test of homogeneity</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-2-analysis-of-paired-continous-data" id="toc-part-2-analysis-of-paired-continous-data" class="nav-link" data-scroll-target="#part-2-analysis-of-paired-continous-data">Part 2: Analysis of paired continous data</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#paired-t-test" id="toc-paired-t-test" class="nav-link" data-scroll-target="#paired-t-test">Paired t-test</a></li>
  <li><a href="#sign-test-and-wilcoxon-signed-rank-test" id="toc-sign-test-and-wilcoxon-signed-rank-test" class="nav-link" data-scroll-target="#sign-test-and-wilcoxon-signed-rank-test">Sign test and Wilcoxon signed-rank test</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-3-analysis-of-paired-dichotomous-data" id="toc-part-3-analysis-of-paired-dichotomous-data" class="nav-link" data-scroll-target="#part-3-analysis-of-paired-dichotomous-data">Part 3: Analysis of paired dichotomous data</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="SPSS_lab4.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Medical Statistics – Lab 4</h1>
<p class="subtitle lead">SPSS version</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Welcome to lab 4 in the medical statistics course. In this lab, we will focus on the analysis of categorical data and the comparison of proportions between groups. We will also perform several statistical tests for the analysis of paired data.</p>
<section id="part-1-inference-for-categorical-data" class="level1">
<h1>Part 1: Inference for categorical data</h1>
<section id="smoking-and-post-surgical-complications" class="level2">
<h2 class="anchored" data-anchor-id="smoking-and-post-surgical-complications">Smoking and post-surgical complications</h2>
<p>A study was conducted to investigate whether smoking is associated with an increased risk of post-surgical complications. The relationship between smoking status (smoker or non-smoker) and the occurrence of complications following surgery was examined. The outcome of interest was whether or not a complication occurred (yes or no), with smoking status serving as the explanatory variable to compare complication rates between the two groups.</p>
<p>The data from the study are summarized in the following 2x2 contingency table:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Complication</th>
<th>No Complication</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Smokers</td>
<td>8</td>
<td>12</td>
<td>20</td>
</tr>
<tr class="even">
<td>Non-smokers</td>
<td>10</td>
<td>50</td>
<td>60</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>18</td>
<td>62</td>
<td>80</td>
</tr>
</tbody>
</table>
<section id="confidence-intervals-and-hypothesis-testing-for-the-difference-in-proportions-using-the-normal-approximation" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals-and-hypothesis-testing-for-the-difference-in-proportions-using-the-normal-approximation">Confidence intervals and hypothesis testing for the difference in proportions using the normal approximation</h3>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 1">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using the data provided in the table, calculate an approximate 95% confidence interval for the difference in proportions of post-surgical complications between smokers and non-smokers.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 2">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the 95% confidence interval, can we conclude that there is a statistically significant difference in the proportion of post-surgical complications between smokers and non-smokers?</p>
</div>
</div>
<p>We can also use the normal approximation to test the hypothesis that the proportion of complications is the same for smokers and non-smokers. This test is known as the two-sample Z test for equality of proportions.</p>
<p>As explained in the syllabus, the two-sample Z test uses the pooled population proportion <span class="math inline">\(\hat{p}\)</span>, which is calculated as the total number of events divided by the total sample size. This pooled proportion is used under the null hypothesis, which assumes that the two groups share the same underlying proportion. The standard error of the difference in proportions is then calculated as <span class="math inline">\(\sqrt{\hat{p}(1-\hat{p})(1/n_1 + 1/n_2)}\)</span>, where <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> are the sample sizes in the two groups.</p>
<p>In contrast, the 95% confidence interval for the difference in proportions does not rely on the pooled proportion. Instead, it calculates the standard error separately for each group using the observed proportions, resulting in an unpooled standard error: <span class="math inline">\(\sqrt{\frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}}\)</span>, where <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> are the sample proportions for each group. This approach provides an interval that better reflects the variability in the observed data, independent of the null hypothesis assumption.</p>
<p>To conduct the two-sample Z test, we need to create a new dataset containing the above observations. To achieve this, go to <code>File</code> -&gt; <code>New</code> -&gt; <code>Data</code> to create a new data file. Navigate to the <code>Variable View</code> tab and create three variables: <code>Group</code>, <code>Complication</code>, and <code>Frequency</code>. The <code>Group</code> variable should have two levels: <code>Smokers</code> (coded as 1) and <code>Non-smokers</code> (coded as 2), while the <code>Complication</code> variable should have two levels: <code>Complication</code> (coded as 1) and <code>No complication</code> (coded as 2). The <code>Frequency</code> variable will contain the counts of observations for each combination of group and complication status.</p>
<p>Navigate to the <code>Data View</code> tab and enter the data from the contingency table into the new dataset. For example, in the first row in the screenshot below, the <code>Group</code> variable is set to <code>Smokers</code> (value=1), the <code>Complication</code> variable is set to <code>Complication</code> (value=1), and the <code>Frequency</code> variable is set to 8 (number of individuals in that cell of the contingency table). Repeat this process for the remaining rows to enter all the data.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lab4_smoking.PNG" class="img-fluid figure-img"></p>
<figcaption>Screenshot of the SPSS dataset</figcaption>
</figure>
</div>
<p>Once the data is entered, we need to weight the data by the <code>Frequency</code> variable to account for the multiple observations in each cell. To do this, go to <code>Data</code> -&gt; <code>Weight Cases</code>. Select the <code>Frequency</code> variable and click <code>OK</code>.</p>
<p>Finally, we can proceed with the two-sample Z test. Go to <code>Analyze</code> -&gt; <code>Compare Means</code> -&gt; <code>Independent-Samples proportions</code>. Select the <code>Group</code> variable as the <code>Grouping Variable</code> and the <code>Complication</code> variable as the <code>Test Variable</code>. Under <code>Confidence Intervals...</code>, select <code>Wald</code> and <code>Wald (Continuity Corrected)</code> to calculate the approximate 95% confidence intervals for the difference in proportions with and without continuity correction. Under Test Type, select <code>Wald H0 (Continuity Corrected)</code> to conduct the two-sample Z test with continuity correction. Click <code>OK</code> to run the test.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 3">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the results of the test, can we conclude that there is a statistically significant difference in the proportion of post-surgical complications between smokers and non-smokers?</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 4">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 4
</div>
</div>
<div class="callout-body-container callout-body">
<p>In addition to the p-value, The SPSS output also provides two approximate 95% confidence intervals for the difference in proportions. How do these confidence intervals compare to the one you calculated manually?</p>
</div>
</div>
</section>
<section id="checking-of-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="checking-of-assumptions">Checking of assumptions</h3>
<p>For the use of the normal approximation to be valid, the expected number of events and non-events in each group should be at least 5.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check this assumption by calculating the expected counts for each cell in the contingency table.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 5">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 5
</div>
</div>
<div class="callout-body-container callout-body">
<p>Is it reasonable to use the normal approximation in this case?</p>
</div>
</div>
</section>
<section id="fishers-exact-test" class="level3">
<h3 class="anchored" data-anchor-id="fishers-exact-test">Fisher’s exact test</h3>
<p>When the expected cell counts are small, the normal approximation may not be appropriate. In such cases, Fisher’s exact test is recommended for testing the association between two categorical variables.</p>
<p>In SPSS, we can perform Fisher’s exact test by going to <code>Analyze</code> -&gt; <code>Descriptive Statistics</code> -&gt; <code>Crosstabs</code>. Select the <code>Group</code> variable as the <code>Row(s)</code> and the <code>Complication</code> variable as the <code>Column(s)</code>. Click on <code>Statistics</code> and check the box <code>Chi_square</code>. Click on <code>Exact Tests</code> and check the box <code>Exact</code>. Click <code>OK</code> to run the test.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 6">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 6
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the results of Fisher’s exact test, can we conclude that there is a statistically significant difference in the proportion of post-surgical complications between smokers and non-smokers?</p>
</div>
</div>
</section>
</section>
<section id="vaccine-side-effects-across-age-groups" class="level2">
<h2 class="anchored" data-anchor-id="vaccine-side-effects-across-age-groups">Vaccine side effects across age groups</h2>
<p>A study was conducted to investigate whether the occurrence of vaccine side effects differs across age groups. Researchers categorized side effects into three types: none, mild, and severe. The study participants were divided into three age groups: 18–39, 40–59, and 60+, and data was collected on the type of side effect experienced by individuals in each group.</p>
<p>The research objective was to determine whether the distribution of side effects is consistent across these age groups.</p>
<p>The data is summarized in the following contingency table:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Age Group</th>
<th>None</th>
<th>Mild</th>
<th>Severe</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>18–39</td>
<td>50</td>
<td>30</td>
<td>10</td>
<td>90</td>
</tr>
<tr class="even">
<td>40–59</td>
<td>40</td>
<td>40</td>
<td>20</td>
<td>100</td>
</tr>
<tr class="odd">
<td>60+</td>
<td>30</td>
<td>50</td>
<td>40</td>
<td>120</td>
</tr>
<tr class="even">
<td>Total</td>
<td>120</td>
<td>120</td>
<td>70</td>
<td>310</td>
</tr>
</tbody>
</table>
<section id="chi-square-test-of-homogeneity" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-test-of-homogeneity">Chi-square test of homogeneity</h3>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a new dataset in SPSS to enter the data from the contingency table.</p>
</div>
</div>
<p>Using the new dataset, we can perform a chi-square test of homogeneity to determine whether the distribution of side effects is consistent across the three age groups. Go to <code>Analyze</code> -&gt; <code>Descriptive Statistics</code> -&gt; <code>Crosstabs</code>. Select the <code>Age Group</code> variable as the <code>Row(s)</code> and the <code>Side Effect</code> variable as the <code>Column(s)</code>. Click on <code>Statistics</code> and check the box <code>Chi_square</code>. Click <code>OK</code> to run the test.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 7">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 7
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the results of the chi-square test, can we conclude that the distribution of vaccine side effects is consistent across the three age groups?</p>
</div>
</div>
<section id="checking-of-assumptions-1" class="level4">
<h4 class="anchored" data-anchor-id="checking-of-assumptions-1">Checking of assumptions</h4>
<p>To use the chi-square test, the expected cell counts should be at least 5 for most cells.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 8">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 8
</div>
</div>
<div class="callout-body-container callout-body">
<p>Are the expected cell counts greater than 5 for the different cells in the contingency table?</p>
</div>
</div>
</section>
<section id="post-hoc-pairwise-comparisons" class="level4">
<h4 class="anchored" data-anchor-id="post-hoc-pairwise-comparisons">Post-hoc pairwise comparisons</h4>
<p>Finally, we are interested in determining which age groups have significantly different distributions of side effects. We start by comparing the first two age groups (18–39 and 40–59). Assuming the name of the age group variable is <code>Age_Group</code> and the three age groups are coded as 1, 2, and 3, we can filter out the third age group (60+) by going to <code>Data</code> -&gt; <code>Select Cases</code>. Select <code>If condition is satisfied</code> and enter the condition <code>Age_Group &lt; 3</code>. Click <code>OK</code> to filter the data.</p>
<p>Now that the data is filtered, we can perform a chi-square test for the subset of the data corresponding to the first two age groups by repeating the steps described above. Manually adjust the p-value for multiple comparisons using the Bonferroni correction.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Perform the pairwise comparison between the other two pairs of age groups (40–59 and 60+, 18–39 and 60+) using the same approach.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 9">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 9
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the results of the pairwise comparisons, which age groups have significantly different distributions of side effects?</p>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="part-2-analysis-of-paired-continous-data" class="level1">
<h1>Part 2: Analysis of paired continous data</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this part of the lab, we will analyze paired data on pocket depth before and after an intervention. Pocket depth refers to the depth of the gum pockets around teeth, measured using a periodontal probe. It is an important indicator of periodontal health. Healthy gums typically have pocket depths less than 3 mm, while deeper pockets may indicate conditions such as gingivitis or periodontitis.</p>
<p>The dataset <code>pockets_paired.sav</code>, available from the Datasets menu, contains the following columns:</p>
<ul>
<li><code>subjectID</code>: Unique identifier for each participant</li>
<li><code>pocket_depth_before</code>: Average pocket depth (in mm) measured before the intervention</li>
<li><code>pocket_depth_after</code>: Average pocket depth (in mm) measured after the intervention</li>
</ul>
<p>The objective is to determine whether the intervention significantly reduces pocket depth. We will apply three statistical methods to analyze the paired data:</p>
<ol type="1">
<li>Paired t-test</li>
<li>Sign test</li>
<li>Wilcoxon signed-rank test</li>
</ol>
<section id="paired-t-test" class="level3">
<h3 class="anchored" data-anchor-id="paired-t-test">Paired t-test</h3>
<p>We start by performing a paired t-test to compare the average pocket depth before and after the intervention. To conduct this analysis in SPSS, follow these steps:</p>
<ol type="1">
<li><strong>Perform the Test</strong>: Go to <code>Analyze</code> &gt; <code>Compare Means</code> &gt; <code>Paired-Samples T Test</code>.</li>
<li><strong>Select Variables</strong>: Move <code>pocket_depth_before</code> and <code>pocket_depth_after</code> to the <code>Paired Variables</code> box.</li>
<li><strong>Run the Test</strong>: Click <code>OK</code> to run the analysis.</li>
</ol>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 10">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 10
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the results of the paired t-test, can we conclude that the intervention significantly reduces pocket depth?</p>
</div>
</div>
<section id="checking-of-assumptions-2" class="level4">
<h4 class="anchored" data-anchor-id="checking-of-assumptions-2">Checking of assumptions</h4>
<p>To determine whether it is appropriate to apply the paired t-test to these data, we need to verify that the differences in pocket depth before and after the intervention are normally distributed. We can visually inspect the distribution of differences using a histogram.</p>
<p>First, we need to create a new variable that calculates the difference between the two measurements. In SPSS, a new variable can be created by navigating to <code>Transform</code> &gt; <code>Compute Variable</code>. Enter a name for the new variable (e.g., <code>diff</code>) in the <code>Target Variable</code> field and enter the expression <code>pocket_depth_after - pocket_depth_before</code> in the <code>Numeric Expression</code> field. Then, click <code>OK</code> to create the new variable.</p>
<p>Next, we can create a histogram of the differences in pocket depth to visually assess the normality of the distribution by following these steps:</p>
<ol type="1">
<li>Go to <code>Graphs</code> &gt; <code>Legacy Dialogs</code> &gt; <code>Histogram</code>.</li>
<li>Select the <code>diff</code> variable as the <code>Variable</code> and click <code>OK</code>.</li>
</ol>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 11">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 11
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the histogram, do the differences in pocket depth appear to be approximately normally distributed?</p>
</div>
</div>
</section>
</section>
<section id="sign-test-and-wilcoxon-signed-rank-test" class="level3">
<h3 class="anchored" data-anchor-id="sign-test-and-wilcoxon-signed-rank-test">Sign test and Wilcoxon signed-rank test</h3>
<p>The sign test is a non-parametric test used to compare two related samples. It is based on the signs of the differences between the pairs of observations. We will apply the sign test to the pocket depth data to determine whether the intervention has a significant effect.</p>
<p>The Wilcoxon signed-rank test is another non-parametric test used to compare two related samples. It is based on the ranks of the absolute differences between the pairs of observations. In this case, the sign test is more appropriate because the Wilcoxon signed-rank test requires the assumption of symmetry in the distribution of differences, whereas the previously constructed histogram suggests that the distribution of these differences is left-skewed.</p>
<p>To perform the sign test and the Wilcoxon signed-rank test in SPSS, follow these steps:</p>
<ol type="1">
<li><strong>Perform the Test</strong>: <code>Nonparametric Tests</code> &gt; <code>Legacy Dialogs</code> &gt; <code>2 Related Samples</code>.</li>
<li><strong>Select Variables</strong>: Move <code>pocket_depth_before</code> and <code>pocket_depth_after</code> to the <code>Test Pairs</code> box.</li>
<li><strong>Run the Test</strong>: Check the <code>Sign</code> box as well as the <code>Wilcoxon</code> box and click <code>OK</code> to run the analysis.</li>
</ol>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 12">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 12
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the results of the sign test, can we conclude that the intervention significantly reduces pocket depth?</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 13">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 13
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the results of the Wilcoxon signed-rank test, can we conclude that the intervention significantly reduces pocket depth?</p>
</div>
</div>
</section>
</section>
</section>
<section id="part-3-analysis-of-paired-dichotomous-data" class="level1">
<h1>Part 3: Analysis of paired dichotomous data</h1>
<p>In this part of the lab, we will analyze paired dichotomous data from a study investigating the skin response to two substances: <strong>dinitrochlorobenzene (DNCB)</strong>, a contact allergen, and <strong>croton oil</strong>, a skin irritant. The objective is to determine whether the proportion of patients with a negative response to DNCB is the same as the proportion with a negative response to croton oil.</p>
<p>The data, summarized in the following table, represents the results of simultaneous skin reaction tests on 173 patients with skin cancer:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>DNCB +ve</th>
<th>DNCB -ve</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Croton oil +ve</strong></td>
<td>81</td>
<td>23</td>
<td>104</td>
</tr>
<tr class="even">
<td><strong>Croton oil -ve</strong></td>
<td>48</td>
<td>21</td>
<td>69</td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td>129</td>
<td>44</td>
<td>173</td>
</tr>
</tbody>
</table>
<p>Because the data are paired, we will use the McNemar test to compare the proportions of positive and negative responses to DNCB and croton oil.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Exercise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a new dataset in SPSS to enter the data from the contingency table.</p>
</div>
</div>
<p>Using the data entered in SPSS, we can perform the McNemar test to compare the proportions of positive and negative responses to DNCB and croton oil. To conduct this analysis in SPSS, go to <code>Analyze</code> &gt; <code>Descriptive Statistics</code> &gt; <code>Crosstabs</code>. Move the variables <code>DNCB</code> and <code>Croton_oil</code> to the <code>Row(s)</code> and <code>Column(s)</code> boxes. In the <code>Statistics</code> dialog box, check the <code>McNemar</code> box, uncheck the <code>Chi-square</code> box, and click <code>Continue</code>. Then, click <code>OK</code> to run the analysis.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="Question 14">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 14
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the results of the McNemar test, can we conclude that there is a significant difference in the proportions of patients with a negative response to DNCB and croton oil? If so, can you determine which substance is associated with a higher proportion of negative responses?</p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>